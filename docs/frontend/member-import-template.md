# 收件人成员导入模板

## 📋 **导入格式说明**

### 支持的文件格式
- **Excel格式**: `.xlsx`, `.xls`
- **CSV格式**: `.csv` (UTF-8编码)

### 文件大小限制
- **最大文件大小**: 10MB
- **最大记录数**: 10,000条

## 📊 **Excel模板结构**

### 必填字段
| 列名 | 字段名 | 数据类型 | 说明 | 示例 |
|------|--------|----------|------|------|
| A | 用户ID | 文本 | 唯一标识，不能重复 | `admin001` |
| B | 用户名称 | 文本 | 用户显示名称 | `张三 - 系统管理员` |
| C | 所属组 | 文本 | 组代码，多个用逗号分隔 | `ADMIN_GROUP,ALL_EMPLOYEES` |

### 可选字段
| 列名 | 字段名 | 数据类型 | 说明 | 示例 |
|------|--------|----------|------|------|
| D | 手机号 | 文本 | 11位手机号码 | `13800138000` |
| E | 邮箱 | 文本 | 有效的邮箱地址 | `zhangsan@company.com` |
| F | IM账号 | 文本 | 企业IM账号 | `zhangsan` |
| G | 偏好渠道 | 文本 | 渠道代码，多个用逗号分隔 | `IN_APP,EMAIL,SMS` |
| H | 状态 | 文本 | 启用/禁用 | `启用` 或 `禁用` |

## 📝 **Excel模板示例**

```
| 用户ID    | 用户名称        | 所属组                    | 手机号      | 邮箱                  | IM账号   | 偏好渠道           | 状态 |
|-----------|----------------|---------------------------|-------------|----------------------|----------|-------------------|------|
| admin001  | 张三-系统管理员 | ADMIN_GROUP,ALL_EMPLOYEES | 13800138000 | zhangsan@company.com | zhangsan | IN_APP,EMAIL,IM   | 启用 |
| admin002  | 李四-安全管理员 | ADMIN_GROUP,ALL_EMPLOYEES | 13800138001 | lisi@company.com     | lisi     | IN_APP,EMAIL,SMS  | 启用 |
| ops001    | 王五-运维工程师 | OPS_TEAM,ALL_EMPLOYEES    | 13800138002 | wangwu@company.com   | wangwu   | IN_APP,SMS,IM     | 启用 |
| dev001    | 赵六-前端工程师 | DEV_TEAM,ALL_EMPLOYEES    | 13800138003 | zhaoliu@company.com  | zhaoliu  | IN_APP,EMAIL      | 禁用 |
```

## 📋 **CSV模板示例**

```csv
用户ID,用户名称,所属组,手机号,邮箱,IM账号,偏好渠道,状态
admin001,张三-系统管理员,"ADMIN_GROUP,ALL_EMPLOYEES",13800138000,zhangsan@company.com,zhangsan,"IN_APP,EMAIL,IM",启用
admin002,李四-安全管理员,"ADMIN_GROUP,ALL_EMPLOYEES",13800138001,lisi@company.com,lisi,"IN_APP,EMAIL,SMS",启用
ops001,王五-运维工程师,"OPS_TEAM,ALL_EMPLOYEES",13800138002,wangwu@company.com,wangwu,"IN_APP,SMS,IM",启用
dev001,赵六-前端工程师,"DEV_TEAM,ALL_EMPLOYEES",13800138003,zhaoliu@company.com,zhaoliu,"IN_APP,EMAIL",禁用
```

## 🔧 **字段规则说明**

### 用户ID
- **格式**: 字母、数字、下划线组合
- **长度**: 3-50个字符
- **唯一性**: 系统内唯一，不能重复
- **示例**: `admin001`, `user_123`, `employee001`

### 用户名称
- **格式**: 任意文本
- **长度**: 1-100个字符
- **建议**: 包含姓名和职位信息
- **示例**: `张三-系统管理员`, `李四`, `王五(运维)`

### 所属组
- **格式**: 组代码，多个用英文逗号分隔
- **可选值**: 
  - `ADMIN_GROUP` - 系统管理员组
  - `OPS_TEAM` - 运维团队
  - `DEV_TEAM` - 开发团队
  - `PRODUCT_TEAM` - 产品团队
  - `ALL_EMPLOYEES` - 全体员工
- **示例**: `ADMIN_GROUP,ALL_EMPLOYEES`

### 手机号
- **格式**: 11位数字
- **验证**: 符合中国大陆手机号格式
- **示例**: `13800138000`, `18912345678`

### 邮箱
- **格式**: 标准邮箱格式
- **验证**: 包含@符号和有效域名
- **示例**: `user@company.com`, `admin@example.org`

### IM账号
- **格式**: 字母、数字、下划线组合
- **长度**: 3-50个字符
- **示例**: `zhangsan`, `user_123`, `admin001`

### 偏好渠道
- **格式**: 渠道代码，多个用英文逗号分隔
- **可选值**:
  - `IN_APP` - 站内信
  - `SMS` - 短信
  - `EMAIL` - 邮件
  - `IM` - 企业IM
- **示例**: `IN_APP,EMAIL,SMS`

### 状态
- **可选值**: `启用`, `禁用`, `enabled`, `disabled`, `true`, `false`
- **默认值**: 如果为空，默认为启用
- **示例**: `启用`, `禁用`

## ⚠️ **导入注意事项**

### 数据验证
1. **必填字段检查**: 用户ID、用户名称、所属组不能为空
2. **格式验证**: 手机号、邮箱格式必须正确
3. **唯一性检查**: 用户ID在系统中必须唯一
4. **组代码验证**: 所属组必须是系统中已存在的组

### 错误处理
1. **跳过错误行**: 遇到错误数据会跳过该行，继续处理其他行
2. **错误报告**: 导入完成后会显示详细的错误报告
3. **部分成功**: 即使部分数据有错误，正确的数据仍会被导入

### 性能建议
1. **分批导入**: 建议每次导入不超过1000条记录
2. **避免重复**: 导入前检查用户ID是否已存在
3. **数据清理**: 确保数据格式正确，避免多余的空格

## 📥 **导入操作步骤**

### 1. 准备数据文件
- 下载模板文件
- 按照格式要求填写数据
- 检查数据完整性和格式

### 2. 执行导入
- 点击"导入成员"按钮
- 选择准备好的文件
- 确认导入设置

### 3. 查看结果
- 等待导入完成
- 查看导入结果报告
- 处理失败记录（如有）

### 4. 验证数据
- 在成员列表中验证导入的数据
- 检查成员的组分配是否正确
- 确认偏好渠道设置

## 🔄 **导入结果说明**

### 成功导入
```json
{
  "totalCount": 100,
  "successCount": 95,
  "failedCount": 5,
  "message": "导入完成，成功95条，失败5条"
}
```

### 失败记录示例
```json
{
  "failedRecords": [
    {
      "row": 10,
      "userId": "invalid001",
      "error": "用户ID格式不正确"
    },
    {
      "row": 15,
      "userId": "duplicate002",
      "error": "用户ID已存在"
    }
  ]
}
```

## 📤 **导出功能**

### 导出格式
- **Excel格式**: 包含完整的成员信息和格式
- **CSV格式**: 纯文本格式，便于其他系统处理

### 导出内容
- 所有成员的完整信息
- 支持按条件筛选导出
- 包含所属组和偏好渠道信息

### 使用场景
- **数据备份**: 定期导出成员数据进行备份
- **数据迁移**: 将成员数据迁移到其他系统
- **数据分析**: 导出数据进行离线分析

---

**下载模板**: 在成员管理页面点击"导入成员"按钮，可下载标准的Excel模板文件。
